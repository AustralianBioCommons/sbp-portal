<!-- Main Navigation Bar -->
<nav class="navbar relative">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center">
      <!-- Logo and Brand (Left corner) -->
      <div class="flex items-center">
        <button
          class="flex-shrink-0 !p-0 !border-0 !bg-transparent hover:!bg-transparent"
          (click)="navigate('/themes', { tab: 'binder-design' })"
          (keydown.enter)="navigate('/themes', { tab: 'binder-design' })"
          (keydown.space)="navigate('/themes', { tab: 'binder-design' })"
          aria-label="Navigate to home page"
        >
          <img class="w-auto" src="/assets/sbp-logo.png" alt="SBP Portal" />
        </button>
      </div>

      <!-- Compact Menu Button (Right side) -->
      <div class="flex items-center ml-auto">
        <!-- Compact Menu Toggle Button -->
        <app-button
          variant="secondary"
          widthClass="w-auto"
          colorClasses="compact-menu-button relative p-2 hover:shadow-lg"
          borderRadius="rounded-lg"
          (click)="toggleMobileMenu(); $event.stopPropagation()"
          [class.active]="isMobileMenuOpen()"
          type="button"
        >
          <!-- Menu Icon using ng-icons -->
          <ng-icon
            [name]="isMobileMenuOpen() ? 'heroXMark' : 'heroBars3'"
            class="w-5 h-5 transition-transform duration-200 pointer-events-none"
            [class.rotate-90]="isMobileMenuOpen()"
          >
          </ng-icon>

          <!-- Menu Label -->
          <span class="sr-only">{{
            isMobileMenuOpen() ? "Close menu" : "Open menu"
          }}</span>
        </app-button>
      </div>
    </div>
  </div>

  <!-- Compact Navigation Menu (Right-aligned, Top-positioned) -->
  @if (isMobileMenuOpen()) {
  <div
    class="compact-menu absolute top-0 right-0 w-80 z-50 bg-gray-50 border border-gray-200 shadow-xl rounded-lg"
    [@slideInOut]
  >
    <!-- Menu Content -->
    <div class="px-4 py-4">
      <!-- Navigation Items -->
      <div class="space-y-0.5">
        @for (item of navItems; track item.label) {
        <!-- Simple nav item -->
        @if (!item.children && shouldShowNavItem(item, (isAuthenticated$ |
        async) || false)) {
        <div>
          <app-button
            variant="secondary"
            widthClass="w-full"
            [active]="isNavItemActive(item)"
            (click)="
              item.path
                ? navigate(item.path, item.queryParams)
                : executeAction(item.action)
            "
          >
            @if (item.icon && !item.image) {
            <ng-icon [name]="item.icon" class="text-sm w-4 h-4"></ng-icon>
            } @if (item.image) {
            <img
              [src]="item.image"
              [alt]="item.label + ' icon'"
              class="w-4 h-4 object-contain"
            />
            }
            <span>{{ item.label }}</span>
          </app-button>
        </div>
        }

        <!-- Nav item with children (Home item with close button) -->
        @if (item.children) {
        <div class="mb-2">
          <div
            class="flex items-center justify-between px-3 py-1.5 font-semibold text-black"
            [class.nav-parent-active]="isParentNavItemActive(item)"
          >
            <div class="flex items-center space-x-2">
              @if (item.icon && !item.image) {
              <ng-icon [name]="item.icon" class="w-4 h-4"></ng-icon>
              } @if (item.image) {
              <img
                [src]="item.image"
                [alt]="item.label + ' icon'"
                class="w-4 h-4 object-contain"
              />
              }
              <span>{{ item.label }}</span>
            </div>
            <!-- Close button aligned with Home (first item with children) -->
            @if (item.label === 'Home') {
            <app-button
              variant="secondary"
              widthClass="w-auto"
              colorClasses="p-1"
              (click)="closeMobileMenu()"
              type="button"
            >
              <ng-icon name="heroXMark" class="w-6 h-6"></ng-icon>
              <span class="sr-only">Close menu</span>
            </app-button>
            }
          </div>
          <div class="ml-3 mt-1 space-y-0.5">
            @for (child of item.children; track child.label) { @if
            (shouldShowNavItem(child, (isAuthenticated$ | async) || false)) {
            <app-button
              variant="secondary"
              widthClass="w-full"
              [active]="isNavItemActive(child)"
              (click)="
                child.path
                  ? navigate(child.path, child.queryParams)
                  : executeAction(child.action)
              "
            >
              <span>{{ child.label }}</span>
            </app-button>
            } }
          </div>
        </div>
        } }
      </div>
    </div>
  </div>
  }
</nav>
